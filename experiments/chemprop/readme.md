# Chemprop

## Installation
To take advantage of custom Chemprop capabilities (namely, using L1 regularization), we built Chemprop 1.7 from source. To do so, follow the Installing From Source instructions provided at https://github.com/chemprop/chemprop/tree/v1.7.1.
```bash
git clone https://github.com/chemprop/chemprop --branch v1.7.1 --single-branch
```
Then, to include our Chemprop modifications, move our modified python files into the chemprop directories.
```bash
mv train_FLASK.py chemprop/chemprop/train/train.py
mv args_FLASK.py chemprop/chemprop/args.py
```

Also, `boom` must also be installed of course. 

## Dataset Creation
To create the training data, simply run [this Jupyter Notebook](make_data.ipynb).

## Usage
All Chemprop model training experiments can be reproduced by executing the relevant `{prop_name}_OOD.sbatch` scripts in the [OOD_Experiments](OOD_Experiments) directory.

After a model is trained, model predictions for both In-Distribution and Out-of-Distribution molecules can be generated by running the relevant `predict.sh` script in the directory of the trained model. See [Here](OOD_Experiments/10k_density_OOD) for example.

## Results
### 10K Dataset

<p align="center">
<img src="OOD_Experiments/10k_density_OOD/10k_Density_parity_plot.png" width="300" /> 
<img src="OOD_Experiments/10k_hof_OOD/10k_HoF_parity_plot.png", width="300" />
</p>

### QM9 Datasets

<p align="center">
<img src="OOD_Experiments/qm9_alpha_OOD/QM9_alpha_parity_plot.png" width="300" /> 
<img src="OOD_Experiments/qm9_cv_OOD/QM9_cv_parity_plot.png" width="300" /> 
<img src="OOD_Experiments/qm9_gap_OOD/QM9_gap_parity_plot.png" width="300" />
<img src="OOD_Experiments/qm9_homo_OOD/QM9_homo_parity_plot.png" width="300" />
<img src="OOD_Experiments/qm9_lumo_OOD/QM9_lumo_parity_plot.png" width="300" />
<img src="OOD_Experiments/qm9_mu_OOD/QM9_mu_parity_plot.png" width="300" />
<img src="OOD_Experiments/qm9_r2_OOD/QM9_r2_parity_plot.png" width="300" />
<img src="OOD_Experiments/qm9_zpve_OOD/QM9_zpve_parity_plot.png" width="300" />
</p>
